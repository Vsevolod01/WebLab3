<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
        PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:p="http://primefaces.org/ui"
      lang="ru">

<h:head>
    <title>Lab 3</title>
    <h:outputScript library="primefaces" name="jquery/jquery.js" target="head"/>
    <h:outputStylesheet library="css" name="header.css" target="head"/>
    <h:outputStylesheet library="css" name="style.css" target="head"/>
    <h:outputStylesheet library="css" name="main.css" target="head"/>
</h:head>

<h:body>
    <ui:include src="templates/header.html"/>
    <h:form id="hiddenForm" style="display: none">
        <h:inputText styleClass="pointX" value="#{dotsBean.dot.x}"/>
        <h:inputText styleClass="pointY" value="#{dotsBean.dot.y}"/>
        <h:inputText styleClass="pointR" value="#{dotsBean.dot.r}"/>
        <h:inputText styleClass="pointResult" value="#{dotsBean.dot.result}"/>
        <h:inputHidden type="hidden" id="isFromGraphic"/>
        <h:commandButton styleClass="submitSvg" action="#{dotsBean.addDot}">
            <f:ajax execute="hiddenForm" render="valuesTable"
                    onevent="myFunc"/>
        </h:commandButton>
    </h:form>
    <h:form id="newEntryForm">
        <div class="selectors">
            <div class="selector">
                <label class="selector-description">Выбор X:</label>
                <p:inputText id="x-label" value="#{dotsBean.dot.x}" style="display: none"/>
                <div class="checkbox-with-label">
                    <p:commandButton type="submit" class="button-input" process="@form" update="x-label"
                                     action="#{dotsBean.dot.setX(-5)}"
                                     value="-5" name="x"/>
                </div>
                <div class="checkbox-with-label">
                    <p:commandButton type="submit" class="button-input" process="@form" update="x-label"
                                     action="#{dotsBean.dot.setX(-4)}"
                                     value="-4" name="x"/>
                </div>
                <div class="checkbox-with-label">
                    <p:commandButton type="submit" class="button-input" process="@form" update="x-label"
                                     action="#{dotsBean.dot.setX(-3)}"
                                     value="-3" name="x"/>
                </div>
                <div class="checkbox-with-label">
                    <p:commandButton type="submit" class="button-input" process="@form" update="x-label"
                                     action="#{dotsBean.dot.setX(-2)}"
                                     value="-2" name="x"/>
                </div>
                <div class="checkbox-with-label">
                    <p:commandButton type="submit" class="button-input" process="@form" update="x-label"
                                     action="#{dotsBean.dot.setX(-1)}"
                                     value="-1" name="x"/>
                </div>
                <div class="checkbox-with-label">
                    <p:commandButton type="submit" class="button-input" process="@form" update="x-label"
                                     action="#{dotsBean.dot.setX(0)}"
                                     value="0" name="x"/>
                </div>
                <div class="checkbox-with-label">
                    <p:commandButton type="submit" class="button-input" process="@form" update="x-label"
                                     action="#{dotsBean.dot.setX(1)}"
                                     value="1" name="x"/>
                </div>
                <div class="checkbox-with-label">
                    <p:commandButton type="submit" class="button-input" process="@form" update="x-label"
                                     action="#{dotsBean.dot.setX(2)}"
                                     value="2" name="x"/>
                </div>
                <div class="checkbox-with-label">
                    <p:commandButton type="submit" class="button-input" process="@form" update="x-label"
                                     action="#{dotsBean.dot.setX(3)}"
                                     value="3" name="x"/>
                </div>
            </div>
            <div class="selector">
                <div class="selector-description">Выбор Y:</div>
                <div class="y-selector">
                    <p:inputText value="#{dotsBean.y}"
                                 id="Y_field"
                                 required="true"
                                 requiredMessage="Выберите Y"
                                 class="text-input"
                                 name="y"
                                 placeholder="(-3; 5)">
                        <f:validator validatorId="y_validator"/>
                    </p:inputText>
                    <p:message id="y_error_message" for="Y_field" showSummary="true" showDetail="false" style="color: darkred"/>
                </div>
            </div>
            <div class="selector">
                <label class="selector-description">Выбор R:</label>
                <p:inputText id="r-label" value="#{dotsBean.dot.r}" style="display: none"/>
                <div class="checkbox-with-label">
                    <p:commandButton type="submit" class="button-input" process="@form" update="r-label"
                                     action="#{dotsBean.dot.setR(1)}" onclick="drawDotsFromTable()"
                                     value="1" name="r"/>
                </div>
                <div class="checkbox-with-label">
                    <p:commandButton type="submit" class="button-input" process="@form" update="r-label"
                                     action="#{dotsBean.dot.setR(1.5)}" onclick="drawDotsFromTable()"
                                     value="1.5" name="r"/>
                </div>
                <div class="checkbox-with-label">
                    <p:commandButton type="submit" class="button-input" process="@form" update="r-label"
                                     action="#{dotsBean.dot.setR(2)}" onclick="drawDotsFromTable()"
                                     value="2" name="r"/>
                </div>
                <div class="checkbox-with-label">
                    <p:commandButton type="submit" class="button-input" process="@form" update="r-label"
                                     action="#{dotsBean.dot.setR(2.5)}" onclick="drawDotsFromTable()"
                                     value="2.5" name="r"/>
                </div>
                <div class="checkbox-with-label">
                    <p:commandButton type="submit" class="button-input" process="@form" update="r-label"
                                     action="#{dotsBean.dot.setR(3)}" onclick="drawDotsFromTable()"
                                     value="3" name="r"/>
                </div>
            </div>
            <h:commandButton id="submit-button"
                             class="submit"
                             disabled="false"
                             type="submit"
                             action="#{dotsBean.addDot}"
                             value="Отправить">
                <f:ajax execute="newEntryForm" render="valuesTable y_error_message" onevent="myFunc"/>
            </h:commandButton>
            <h:commandButton id="clear-button"
                             class="submit"
                             disabled="false"
                             type="submit"
                             action="#{dotsBean.clearTable()}"
                             value="Очистить таблицу"
                             onclick="clearTable(); clearPlot()">
                <f:ajax execute="@this" render="valuesTable"/>
            </h:commandButton>
            <h:button class="submit" outcome="index" value="Посмотреть на часы"/>
        </div>
        <div class="svg-container">
            <ui:include src="templates/graph.html"/>
        </div>
    </h:form>
    <h:panelGroup id="valuesTable">
        <h:dataTable class="results" id="results" value="#{dotsBean.dots}" var="dot">
            <h:column>
                <f:facet name="header">X</f:facet>
                #{dot.x}
            </h:column>
            <h:column>
                <f:facet name="header">Y</f:facet>
                #{dot.y}
            </h:column>
            <h:column>
                <f:facet name="header">R</f:facet>
                #{dot.r}
            </h:column>
            <h:column>
                <f:facet name="header">Результат</f:facet>
                <h:outputText value="#{dot.result}"
                              styleClass="#{(dot.result) ? 'green' : 'red'}"/>
            </h:column>
            <h:column>
                <f:facet name="header">Текущее время</f:facet>
                #{dot.date}
            </h:column>
        </h:dataTable>
    </h:panelGroup>
    <ui:insert name="scripts">
        <h:outputScript library="js" name="graph.js"/>
        <h:outputScript library="js" name="script.js"/>
    </ui:insert>
</h:body>
</html>